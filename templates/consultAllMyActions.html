{%load static%}
<!doctype html>
<html lang="fr">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8 general">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <!-- <link href={% static "css/PA.css" %} rel="stylesheet" >
    <link href={% static "css/PA2.css" %} rel="stylesheet"> -->
    <link href={% static "css/navbar.css" %} rel="stylesheet" >
    <link href={% static "css/PAE.css" %} rel="stylesheet" >
    <link href={% static "css/ConsultAllMyActions.css" %} rel="stylesheet" >
    <link rel="shortcut icon" href="../static/images/favicon.ico">

    <title>Plan d'action</title>
  </head>

  <body>
    {%include 'navbar.html'%}
    {%include 'messages.html'%}

    <div class="userTable">
        
    <h1>Les Actions à faire</h1>
        <table class="userTab">
          <tr>
            <th class="theaderColored"><b>Causes retenus</b></th>
            <th class="theaderColored"><b>Actions correctives</b></th>
            <th class="theaderColored"><b>responsable/<br>Signature</b></th>
            <th class="theaderColored"><b>Date prévue</b></th>
            <th class="theaderColored" colspan="4"><b>STATUS</b></th>
            {%if request.session.user.Name == pilote %}
              <th></th>
            {%endif%}
          </tr>
                {%if myActs%}
                    {%for action in myActs%}
                        <tr class="row">
                            <td class="theader" id="causesRetenues">{{action.cause|safe}}</td>
                            <td class="theader" id="actionsCorrectives">{{action.action|safe}}</td>
                            <td class="theader" id="responsable">{{action.resp}}</td>
                            <td class="theader" id="datePrevue">{{action.datePrevue}}</td>
                            <td class="ltheader" id="P">
                                {%if action.P %}
                                <form action="UpdateP" method="post" id="Pform{{action.idAct}}">
                                    {%csrf_token%}
                                    <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                    <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                    <input type="checkbox" name="P" id="P" value="{{action.P}}" checked onclick="setTimeout(Pform(this), 0)" disabled >
                                </form>
                                {%else%}
                                <form action="UpdateP" method="post" id="Pform{{action.idAct}}">
                                    {%csrf_token%}
                                    <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                    <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                    <input type="checkbox" name="P" id="P" value="{{action.P}}" onclick="setTimeout(Pform(this), 0)" disabled>
                                </form>
                                {%endif%}
                            </td>
                            <td class="ltheader" id="D">
                                {%if action.D %}
                                <form action="UpdateD" method="post" id="Dform{{action.idAct}}">
                                    {%csrf_token%}
                                    <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                    <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                    <input type="checkbox" name="D" id="D" value="{{action.D}}" checked onclick="setTimeout(Dform(this), 0)" {%if request.session.user.Name not in action.resp %} disabled {%endif%}>
                                </form>
                                {%else%}
                                <form action="UpdateD" method="post" id="Dform{{action.idAct}}">
                                    {%csrf_token%}
                                    <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                    <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                    <input type="checkbox" name="D" id="D" value="{{action.D}}" onclick="setTimeout(Dform(this), 0)" {%if request.session.user.Name not in action.resp %} disabled {%endif%}>
                                </form>
                                {%endif%}
                            </td>
                            <td class="ltheader" id="C">
                                {%if action.C %}
                                <form action="UpdateC" method="post" id="Cform{{action.idAct}}">
                                    {%csrf_token%}
                                    <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                    <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                    <input type="checkbox" name="C" id="C" value="{{action.C}}" checked onclick="setTimeout(Cform(this), 0)" disabled>
                                </form>
                                {%else%}
                                <form action="UpdateC" method="post" id="Cform{{action.idAct}}">
                                    {%csrf_token%}
                                    <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                    <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                    <input type="checkbox" name="C" id="C" value="{{action.C}}" onclick="setTimeout(Cform(this), 0)" disabled>
                                </form>
                                {%endif%}
                            </td>
                            <td class="ltheader" id="A">
                            {%if action.A %}
                            <form action="UpdateA" method="post" id="Aform{{action.idAct}}">
                                {%csrf_token%}
                                <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                <input type="checkbox" name="A" id="A" value="{{action.A}}" checked onclick="setTimeout(Aform(this), 0)" disabled>
                            </form>
                            {%else%}
                            <form action="UpdateA" method="post" id="Aform{{action.idAct}}">
                                {%csrf_token%}
                                <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                <input type="checkbox" name="A" id="A" value="{{action.A}}" onclick="setTimeout(Aform(this), 0)" disabled>
                            </form>
                            {%endif%}
                            </td>
                        </tr>
                    {%endfor%}
                {%endif%}
            
        </table>
    </div>
    
    <div class="userTable">
        
        <h1>Les Actions à checker</h1>
            <table class="userTab">
              <tr>
                <th class="theaderColored"><b>Causes retenus</b></th>
                <th class="theaderColored"><b>Actions correctives</b></th>
                <th class="theaderColored"><b>responsable/<br>Signature</b></th>
                <th class="theaderColored"><b>Date prévue</b></th>
                <th class="theaderColored" colspan="4"><b>STATUS</b></th>
                {%if request.session.user.Name == pilote %}
                  <th></th>
                {%endif%}
              </tr>
                    {%if myCheckerActs%}
                        {%for action in myCheckerActs%}
                            <tr class="row">
                                <td class="theader" id="causesRetenues">{{action.cause|safe}}</td>
                                <td class="theader" id="actionsCorrectives">{{action.action|safe}}</td>
                                <td class="theader" id="responsable">{{action.resp}}</td>
                                <td class="theader" id="datePrevue">{{action.datePrevue}}</td>
                                <td class="ltheader" id="P">
                                    {%if action.P %}
                                    <form action="UpdateP" method="post" id="Pform{{action.idAct}}">
                                        {%csrf_token%}
                                        <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                        <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                        <input type="checkbox" name="P" id="P" value="{{action.P}}" checked onclick="setTimeout(Pform(this), 0)" disabled>
                                    </form>
                                    {%else%}
                                    <form action="UpdateP" method="post" id="Pform{{action.idAct}}">
                                        {%csrf_token%}
                                        <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                        <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                        <input type="checkbox" name="P" id="P" value="{{action.P}}" onclick="setTimeout(Pform(this), 0)" disabled>
                                    </form>
                                    {%endif%}
                                </td>
                                <td class="ltheader" id="D">
                                    {%if action.D %}
                                    <form action="UpdateD" method="post" id="Dform{{action.idAct}}">
                                        {%csrf_token%}
                                        <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                        <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                        <input type="checkbox" name="D" id="D" value="{{action.D}}" checked onclick="setTimeout(Dform(this), 0)" disabled>
                                    </form>
                                    {%else%}
                                    <form action="UpdateD" method="post" id="Dform{{action.idAct}}">
                                        {%csrf_token%}
                                        <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                        <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                        <input type="checkbox" name="D" id="D" value="{{action.D}}" onclick="setTimeout(Dform(this), 0)" disabled>
                                    </form>
                                    {%endif%}
                                </td>
                                <td class="ltheader" id="C">
                                    {%if action.C %}
                                    <form action="UpdateC" method="post" id="Cform{{action.idAct}}">
                                        {%csrf_token%}
                                        <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                        <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                        <input type="checkbox" name="C" id="C" value="{{action.C}}" checked onclick="setTimeout(Cform(this), 0)" {%if request.session.user.Name  not in pa.C %} disabled {%endif%}>
                                    </form>
                                    {%else%}
                                    <form action="UpdateC" method="post" id="Cform{{action.idAct}}">
                                        {%csrf_token%}
                                        <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                        <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                        <input type="checkbox" name="C" id="C" value="{{action.C}}" onclick="setTimeout(Cform(this), 0)" {%if request.session.user.Name  not in pa.C %} disabled {%endif%}>
                                    </form>
                                    {%endif%}
                                </td>
                                <td class="ltheader" id="A">
                                {%if action.A %}
                                <form action="UpdateA" method="post" id="Aform{{action.idAct}}">
                                    {%csrf_token%}
                                    <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                    <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                    <input type="checkbox" name="A" id="A" value="{{action.A}}" checked onclick="setTimeout(Aform(this), 0)" disabled>
                                </form>
                                {%else%}
                                <form action="UpdateA" method="post" id="Aform{{action.idAct}}">
                                    {%csrf_token%}
                                    <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                    <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                    <input type="checkbox" name="A" id="A" value="{{action.A}}" onclick="setTimeout(Aform(this), 0)" disabled>
                                </form>
                                {%endif%}
                                </td>
                            </tr>
                        {%endfor%}
                    {%endif%}
                
            </table>
        </div>

        <div class="userTable">
        
            <h1>Les Actions à Act</h1>
                <table class="userTab">
                  <tr>
                    <th class="theaderColored"><b>Causes retenus</b></th>
                    <th class="theaderColored"><b>Actions correctives</b></th>
                    <th class="theaderColored"><b>responsable/<br>Signature</b></th>
                    <th class="theaderColored"><b>Date prévue</b></th>
                    <th class="theaderColored" colspan="4"><b>STATUS</b></th>
                    {%if request.session.user.Name == pilote %}
                      <th></th>
                    {%endif%}
                  </tr>
                        {%if myActorActs%}
                            {%for action in myActorActs%}
                                <tr class="row">
                                    <td class="theader" id="causesRetenues">{{action.cause|safe}}</td>
                                    <td class="theader" id="actionsCorrectives">{{action.action|safe}}</td>
                                    <td class="theader" id="responsable">{{action.resp}}</td>
                                    <td class="theader" id="datePrevue">{{action.datePrevue}}</td>
                                    <td class="ltheader" id="P">
                                        {%if action.P %}
                                        <form action="UpdateP" method="post" id="Pform{{action.idAct}}">
                                            {%csrf_token%}
                                            <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                            <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                            <input type="checkbox" name="P" id="P" value="{{action.P}}" checked onclick="setTimeout(Pform(this), 0)" disabled>
                                        </form>
                                        {%else%}
                                        <form action="UpdateP" method="post" id="Pform{{action.idAct}}">
                                            {%csrf_token%}
                                            <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                            <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                            <input type="checkbox" name="P" id="P" value="{{action.P}}" onclick="setTimeout(Pform(this), 0)" disabled>
                                        </form>
                                        {%endif%}
                                    </td>
                                    <td class="ltheader" id="D">
                                        {%if action.D %}
                                        <form action="UpdateD" method="post" id="Dform{{action.idAct}}">
                                            {%csrf_token%}
                                            <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                            <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                            <input type="checkbox" name="D" id="D" value="{{action.D}}" checked onclick="setTimeout(Dform(this), 0)" disabled>
                                        </form>
                                        {%else%}
                                        <form action="UpdateD" method="post" id="Dform{{action.idAct}}">
                                            {%csrf_token%}
                                            <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                            <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                            <input type="checkbox" name="D" id="D" value="{{action.D}}" onclick="setTimeout(Dform(this), 0)" disabled>
                                        </form>
                                        {%endif%}
                                    </td>
                                    <td class="ltheader" id="C">
                                        {%if action.C %}
                                        <form action="UpdateC" method="post" id="Cform{{action.idAct}}">
                                            {%csrf_token%}
                                            <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                            <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                            <input type="checkbox" name="C" id="C" value="{{action.C}}" checked onclick="setTimeout(Cform(this), 0)" disabled>
                                        </form>
                                        {%else%}
                                        <form action="UpdateC" method="post" id="Cform{{action.idAct}}">
                                            {%csrf_token%}
                                            <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                            <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                            <input type="checkbox" name="C" id="C" value="{{action.C}}" onclick="setTimeout(Cform(this), 0)" disabled>
                                        </form>
                                        {%endif%}
                                    </td>
                                    <td class="ltheader" id="A">
                                    {%if action.A %}
                                    <form action="UpdateA" method="post" id="Aform{{action.idAct}}">
                                        {%csrf_token%}
                                        <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                        <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                        <input type="checkbox" name="A" id="A" value="{{action.A}}" checked onclick="setTimeout(Aform(this), 0)" {%if request.session.user.Name not in pa.A %} disabled {%endif%}>
                                    </form>
                                    {%else%}
                                    <form action="UpdateA" method="post" id="Aform{{action.idAct}}">
                                        {%csrf_token%}
                                        <input type="text" name="AllAct" id="AllAct" value="True" hidden>
                                        <input type="number" name="idAct" id="idAct" value="{{action.idAct}}" hidden>
                                        <input type="checkbox" name="A" id="A" value="{{action.A}}" onclick="setTimeout(Aform(this), 0)" {%if request.session.user.Name not in pa.A %} disabled {%endif%}>
                                    </form>
                                    {%endif%}
                                    </td>
                                </tr>
                            {%endfor%}
                        {%endif%}
                    
                </table>
            </div>

    <script src="{% static "js/UpdatePDCA.js" %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

  </body>
</html>